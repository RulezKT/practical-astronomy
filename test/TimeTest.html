<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Time Tests</title>
        <link rel="stylesheet" href="qunit-1.19.0.css">
    </head>
    <body>
        <div id="qunit"></div>
        <div id="qunit-fixture"></div>
        <script src="./qunit-1.19.0.js"></script>
        <script src="../src/Time.js"></script>
        <script>

            var time = new Time();

            module("1 - Calendars");

            test("Days in month when not a leap year", function(assert) {
                assert.equal(time.daysInMonth(2015, 1), 31);
                assert.equal(time.daysInMonth(2015, 2), 28);
                assert.equal(time.daysInMonth(2015, 3), 31);
                assert.equal(time.daysInMonth(2015, 4), 30);
                assert.equal(time.daysInMonth(2015, 5), 31);
                assert.equal(time.daysInMonth(2015, 6), 30);
                assert.equal(time.daysInMonth(2015, 7), 31);
                assert.equal(time.daysInMonth(2015, 8), 31);
                assert.equal(time.daysInMonth(2015, 9), 30);
                assert.equal(time.daysInMonth(2015, 10), 31);
                assert.equal(time.daysInMonth(2015, 11), 30);
                assert.equal(time.daysInMonth(2015, 12), 31);
            });

            test("Days in February when a common leap year", function(assert) {
                assert.equal(time.daysInMonth(2016, 2), 29);
            });

            test("Days in February when a century leap year", function(assert) {
                assert.equal(time.daysInMonth(2000, 2), 29);
            });

            test("Days in February when not a century leap year", function(assert) {
                assert.equal(time.daysInMonth(1900, 2), 28);
            });

            test("Days in month before first year of Gregorian calendar", function(assert) {
                assert.throws(
                    function() {
                        time.daysInMonth(1582, 10);
                    },
                    new TimeError("month must be in Gregorian Calendar, i.e. >= 1582/11")
                );
            });

            module("2 - The date of Easter");

            test("Date of Easter", function(assert) {
                assert.equal(time.dateOfEaster(1974).toUTCString(), new Date(1974, 3, 14).toUTCString());
            });

            test("Earliest date of Easter", function(assert) {
                assert.equal(time.dateOfEaster(1818).toUTCString(), new Date(1818, 2, 22).toUTCString());
            });

            test("Latest date of Easter", function(assert) {
                assert.equal(time.dateOfEaster(1943).toUTCString(), new Date(1943, 3, 25).toUTCString());
            });

            test("Date of Easter on first year of Gregorian calendar", function(assert) {
                assert.equal(time.dateOfEaster(1583).toUTCString(), new Date(1583, 3, 10).toUTCString());
            });

            test("Date of Easter before first year of Gregorian calendar", function(assert) {
                assert.throws(
                    function() {
                        time.dateOfEaster(1582);
                    },
                    new TimeError("year must be in Gregorian Calendar, i.e. >= 1583")
                );
            });

            module("3 - Converting the date to the day number");

            test("Date to day number", function(assert) {
                assert.equal(time.dateToDayNumber(1985, 2, 17), 48); // month <= 2
                assert.equal(time.dateToDayNumber(1985, 11, 13), 317); // month > 2
                assert.equal(time.dateToDayNumber(1984, 11, 13), 318); // Leap year
            });

            test("Date to day number before Gregorian calendar", function(assert) {
                assert.throws(
                    function() {
                        time.dateToDayNumber(1582, 10, 14);
                    },
                    new TimeError("date must be in Gregorian Calendar, i.e. >= 1582/10/15")
                );
            });

            test("Date to days elapsed since epoch", function(assert) {
                assert.equal(time.dateToDaysElapsedSinceEpoch(1985, 2, 17), -1778); // before epoch
                assert.equal(time.dateToDaysElapsedSinceEpoch(1989, 12, 31), 0); // epoch
                assert.equal(time.dateToDaysElapsedSinceEpoch(1990, 1, 1), 1); // day after epoch
                assert.equal(time.dateToDaysElapsedSinceEpoch(2016, 9, 20), 9760); // after epoch
            });

            test("Date to days elapsed since epoch before Gregorian calendar", function(assert) {
                assert.throws(
                    function() {
                        time.dateToDaysElapsedSinceEpoch(1582, 10, 14);
                    },
                    new TimeError("date must be in Gregorian Calendar, i.e. >= 1582/10/15")
                );
            });

            module("4 - Julian day numbers");

            test("Date to julian day number", function(assert) {
                assert.equal(time.dateToJulianDayNumber(-4712, 1, 1.5), 0);
                assert.equal(time.dateToJulianDayNumber(1985, 2, 17.25), 2446113.75);
                assert.equal(time.dateToJulianDayNumber(1989, 12, 31), 2447891.5);
            });

            test("Date to modified julian day number", function(assert) {
                assert.equal(time.dateToModifiedJulianDayNumber(-4712, 1, 1.5), -2400000.5);
                assert.equal(time.dateToModifiedJulianDayNumber(1985, 2, 17.25), 46113.25);
                assert.equal(time.dateToModifiedJulianDayNumber(1989, 12, 31), 47891);
            });

        </script>
    </body>
</html>
